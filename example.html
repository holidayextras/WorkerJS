<!doctype html>
<html>
	<head>
	  <script type="text/javascript" src="./WorkerJS.js"></script>
	  <script type="text/javascript">
	    var primes=[];
	    var finished = false;
	    
	    WorkerJS({ // TLDR; Functions we want to push into the Worker scope.
	      addPrime: function(somePrime) {
	        primes.push(somePrime);
	      },
	      getPrimes: function() {
	        this.callback(primes);
	      }
	    }, function() { // TLDR; Definition of the Worker.
	      function findPrimesBetween(a, b) {
	        log("Searching for primes between", a, "and", b);
	        
	        for (var i=a; i<b; i++) {
	          var prime = true;
	          for (var j=2; j<i; j++) {
	            if ( (i%j) == 0 ) {
	              prime = false;
	              break;
	            }
	          }
	          if (prime) addPrime(i);
	        }
	        this.callback({ result: "success" });
	      };
	    }, function(instance) { // TLDR; Interacting with the Worker.
	      instance.findPrimesBetween(2, 1000000, function(result) {
	        console.log("Primes between 2 and 1000000:", primes);
	        finished = true;
	      });
	    });
	    
	    // This demonstrates the parallel nature of this demo.
	    var checkProgress = function() {
	      console.log("Found", primes.length, "primes");
	      if (!finished) setTimeout(checkProgress, 1000);
	    };
	    checkProgress();
	  </script>
	</head>
</html>
